---
title: Cipher 5
date: 2023-03-23 20:52:26
tags: cipher
mathjax: true
---

### 密钥配送问题

在使用对称加密的时候，加密方需要向解密方配送密钥，如何安全的传输密钥，就是密钥配送问题。解决这个问题的办法有以下几种

- 事先共享密钥解决：实际中不可行
- 密钥分配中心解决：密钥分配中心可能成为攻击目标，攻击成功了之后会导致基于该方式的通信完全无法进行

```text
1. 密钥中心生成临时密钥
2. 密钥中心用 Alice 的密钥加密临时密钥，把临时密钥传递给 Alice，Alice 用自己的密钥解密获得临时密钥。Bob 以同样的方式获得临时密钥
3. 双方用临时密钥加密小心进行通信
```

- Diffie-Hellman 密钥交换解决

1. 发送者和接收者约定一个质数和一个生成元，例如质数为 19，生成元 5
2. 发送者生成一个伪随机数 11，计算 $5^{11}~mod~19=6$，将 6 发给接收者
3. 接收者随机生成一个伪随机数 8，计算 $5^{8}~mod~19=4$，将 4 发送给发送者
4. 发送者根据收到的 4 计算 $4^{11}~mod~19=16$
5. 接收者根据收到的 6 计算 $6^8~mod~19=16$

双方完成了密钥交换，发送者的密钥为 $5^{11}$，接收者的密钥为 $5^{8}$，双方共同约定的密钥为 $(5^{11})^8~mod~19$，$(5^{8})^{11}~mod~19$

- 公钥密码解决：使用公钥加密，使用解密密钥解密。公钥对所有人公开，但是解密密钥是私有的，只有拥有解密密钥才能解密

<!-- more -->

### 公钥密码

```text
1. Bob 生成一组公钥和私钥
2. Bob 将公钥发给 Alice
3. Alice 用公钥加密自己的消息，发给 Bob
4. Bob 用私钥解密获得消息
```

公钥密码解决了配送问题，但是没有解决密钥公证的问题。

### RSA

加密过程，加密的明文必须小于 $N$

$$
ciphertext=plaintext^{E}~mod~N
$$

其中 $E$ 和 $N$ 的组合就是公钥

解密过程，解密的结果必须小于 $N$

$$
plaintext=ciphertext^{D}~mod~N
$$

其中 $D$ 和 $N$ 的组合就是私钥

$D$、$E$、$N$ 生成步骤：求 $N$ -> 求 $L$ -> 求 $E$ -> 求 $D$

1. 求 $N$：生成两个很大的质数 $p$，$q$，$N=p \times q$，可以使用费马测试 $p$，$q$ 是否符合要求
2. 求 $L$：计算得到 $p-1$，$q-1$ 的最小公倍数 $L=lcm(p-1, q-1)$
3. 求 $E$：找到一个满足在 $(1, L)$ 之间的数，判断 $gcd(E, L) = 1$ 即可，使用欧几里得算法判断
4. 求 $D$：找到一个 D 满足 $ E \times D~mod~L = 1$

### 练习测试

1. 如果这样做，每一个人会知道其他所有剩余人的密钥。每一个人都是密钥中心。相当于每个人都可以知道其他人加密的消息。
2. 三重 DES 仍然是对称密码，没有解决密码配送问题，依然需要传输密钥
3. 1
4. o o x o o
